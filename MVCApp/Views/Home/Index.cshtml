@model List<MVCApp.ViewModels.ProductViewModel>

@{
    ViewData["Title"] = "Home";
}

<!-- Hero Section -->
<section class="hero-section position-relative overflow-hidden">
    <div class="hero-background"></div>
    <div class="container">
        <div class="row align-items-center min-vh-75">
            <div class="col-lg-6">
                <div class="hero-content text-white">
                    <h1 class="display-5 fw-bold mb-3" data-animate="fade-in-up">
                        Discover Amazing Products
                    </h1>
                    <p class="lead mb-3" data-animate="fade-in-up" data-animate-delay="0.2">
                        Shop the latest trends with confidence. Quality products, competitive prices, and exceptional service.
                    </p>
                    <div class="hero-buttons" data-animate="fade-in-up" data-animate-delay="0.4">
                        <a asp-controller="Products" asp-action="Index" class="btn btn-primary me-2">
                            <i class="fas fa-shopping-bag me-1"></i>Shop Now
                        </a>
                        <a href="#featured-products" class="btn btn-outline-light">
                            <i class="fas fa-star me-1"></i>Featured
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="hero-image" data-animate="slide-in-right">
                    <img src="/imges/undraw_shopping_a55o.svg" alt="E-commerce Hero Illustration" class="hero-img img-fluid" style="max-width: 480px; width: 100%; height: auto; box-shadow: 0 4px 32px rgba(108,99,255,0.08); border-radius: 1rem;" loading="lazy">
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="py-4 bg-light">
    <div class="container">
        <div class="row text-center mb-4">
            <div class="col-12">
                <h2 class="h2 fw-bold text-gradient mb-2" data-animate="fade-in-up">Why Us</h2>
                <p class="text-muted" data-animate="fade-in-up" data-animate-delay="0.2">
                    We provide the best shopping experience with quality products and excellent service.
                </p>
            </div>
        </div>
        
        <div class="row g-3">
            <div class="col-md-4" data-animate="fade-in-up" data-animate-delay="0.1">
                <div class="card h-100 border-0 shadow-custom text-center">
                    <div class="card-body p-3">
                        <div class="feature-icon mb-2">
                            <i class="fas fa-shipping-fast fa-2x text-primary"></i>
                        </div>
                        <h6 class="card-title fw-bold">Fast Shipping</h6>
                        <p class="card-text text-muted small">Free shipping on orders over $50. Get your products delivered quickly and safely.</p>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4" data-animate="fade-in-up" data-animate-delay="0.2">
                <div class="card h-100 border-0 shadow-custom text-center">
                    <div class="card-body p-3">
                        <div class="feature-icon mb-2">
                            <i class="fas fa-shield-alt fa-2x text-success"></i>
                        </div>
                        <h6 class="card-title fw-bold">Secure Payment</h6>
                        <p class="card-text text-muted small">Your payment information is protected with bank-level security encryption.</p>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4" data-animate="fade-in-up" data-animate-delay="0.3">
                <div class="card h-100 border-0 shadow-custom text-center">
                    <div class="card-body p-3">
                        <div class="feature-icon mb-2">
                            <i class="fas fa-headset fa-2x text-info"></i>
                        </div>
                        <h6 class="card-title fw-bold">24/7 Customer service</h6>
                        <p class="card-text text-muted small">Our customer service team is available around the clock to help you.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Featured Products Section -->
<section id="featured-products" class="py-4">
    <div class="container">
        <div class="row text-center mb-4">
            <div class="col-12">
                <h2 class="h2 fw-bold text-gradient mb-2" data-animate="fade-in-up">Featured Products</h2>
                <p class="text-muted" data-animate="fade-in-up" data-animate-delay="0.2">
                    Discover our handpicked selection of premium products
                </p>
            </div>
        </div>
        
        @if (Model.Any())
        {
            <div class="row g-3">
                @foreach (var product in Model.Take(8))
                {
                    <div class="col-lg-3 col-md-6" data-animate="fade-in-up">
                        <div class="card product-card h-100 border-0 shadow-custom">
                            <div class="position-relative">
                                @if (!string.IsNullOrEmpty(product.imageUrl))
                                {
                                    <img src="@product.imageUrl" class="card-img-top product-image" alt="@product.Name" 
                                         style="height: 160px; object-fit: cover; cursor: pointer;">
                                }
                                else
                                {
                                    <div class="card-img-top bg-light d-flex align-items-center justify-content-center" 
                                         style="height: 160px;">
                                        <i class="fas fa-image fa-2x text-muted"></i>
                                    </div>
                                }
                                
                                @if (product.SalePrice.HasValue && product.SalePrice < product.Price)
                                {
                                    <span class="badge bg-danger position-absolute top-0 end-0 m-1">
                                        Sale
                                    </span>
                                }
                            </div>

                            <div class="card-body d-flex flex-column p-3">
                                <h6 class="card-title fw-bold mb-1">@product.Name</h6>
                                <p class="card-text text-muted small mb-2">@product.CategoryName</p>
                                
                                <div class="price-section mt-auto">
                                    @if (product.SalePrice.HasValue && product.SalePrice < product.Price)
                                    {
                                        <div class="d-flex align-items-center">
                                            <span class="price text-primary fw-bold">$@product.SalePrice.Value.ToString("F2")</span>
                                            <span class="original-price ms-2">$@product.Price.ToString("F2")</span>
                                        </div>
                                    }
                                    else
                                    {
                                        <span class="price text-primary fw-bold">$@product.Price.ToString("F2")</span>
                                    }
                                </div>

                                <div class="mt-2 d-grid gap-2">
                                    <a asp-controller="Products" asp-action="Details" asp-route-id="@product.Id" 
                                       class="btn btn-outline-primary w-100 btn-sm">
                                        View Details
                                    </a>
                                    <form asp-controller="Products" asp-action="AddToCart" method="post" class="add-to-cart-form mt-1">
                                        <input type="hidden" name="productId" value="@product.Id" />
                                        <input type="hidden" name="quantity" value="1" />
                                        <button type="button" 
                                                class="btn btn-primary btn-sm w-100 add-to-cart-btn"
                                                data-add-to-cart
                                                data-product-id="@product.Id"
                                                data-quantity="1">
                                            Add to Cart
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>

            <div class="row mt-4">
                <div class="col-12 text-center">
                    <a asp-controller="Products" asp-action="Index" class="btn btn-primary">
                        <i class="fas fa-arrow-right me-1"></i>View All Products
                    </a>
                </div>
            </div>
        }
        else
        {
            <div class="text-center py-4">
                <i class="fas fa-box-open fa-3x text-muted mb-2"></i>
                <h5>No Products Available</h5>
                <p class="text-muted small">Check back soon for new products!</p>
            </div>
        }
    </div>
</section>

<!-- Categories Section -->
<section class="py-4 bg-light">
    <div class="container">
        <div class="row text-center mb-4">
            <div class="col-12">
                <h2 class="h2 fw-bold text-gradient mb-2" data-animate="fade-in-up">Shop by Category</h2>
                <p class="text-muted" data-animate="fade-in-up" data-animate-delay="0.2">
                    Explore our wide range of product categories
                </p>
            </div>
        </div>
        <div class="row g-3">
            @if (ViewBag.Categories != null && ViewBag.Categories.Count > 0)
            {
                foreach (var category in ViewBag.Categories)
                {
                    <div class="col-lg-3 col-md-6" data-animate="fade-in-up">
                        <div class="category-card card border-0 shadow-custom text-center">
                            <div class="card-body p-3">
                                <div class="category-icon mb-2">
                                    @{
                                        var iconClass = category.Name.ToLower() switch
                                        {
                                            var name when name.Contains("electronics") || name.Contains("tech") => "fas fa-laptop",
                                            var name when name.Contains("clothing") || name.Contains("fashion") || name.Contains("apparel") => "fas fa-tshirt",
                                            var name when name.Contains("home") || name.Contains("kitchen") || name.Contains("garden") => "fas fa-home",
                                            var name when name.Contains("sports") || name.Contains("fitness") || name.Contains("outdoor") => "fas fa-dumbbell",
                                            var name when name.Contains("books") || name.Contains("education") || name.Contains("learning") => "fas fa-book",
                                            var name when name.Contains("beauty") || name.Contains("cosmetics") || name.Contains("health") => "fas fa-spa",
                                            var name when name.Contains("toys") || name.Contains("games") || name.Contains("entertainment") => "fas fa-gamepad",
                                            var name when name.Contains("automotive") || name.Contains("car") || name.Contains("vehicle") => "fas fa-car",
                                            var name when name.Contains("jewelry") || name.Contains("accessories") => "fas fa-gem",
                                            var name when name.Contains("food") || name.Contains("beverage") || name.Contains("drink") => "fas fa-utensils",
                                            _ => "fas fa-tag"
                                        };
                                    }
                                    <i class="@iconClass fa-2x text-primary"></i>
                                </div>
                                <h6 class="card-title fw-bold">@category.Name</h6>
                                <p class="card-text text-muted small">@category.Description</p>
                                <a asp-controller="Products" asp-action="Index" asp-route-categoryId="@category.Id" class="btn btn-outline-primary btn-sm">Shop Now</a>
                            </div>
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="col-12 text-center text-muted">No categories available.</div>
            }
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animate elements on scroll
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);
    
    document.querySelectorAll('[data-animate]').forEach(el => {
        observer.observe(el);
    });
    
    // Newsletter subscription
    const newsletterForm = document.querySelector('.bg-gradient .input-group');
    if (newsletterForm) {
        const subscribeBtn = newsletterForm.querySelector('button');
        const emailInput = newsletterForm.querySelector('input');
        
        subscribeBtn.addEventListener('click', function() {
            const email = emailInput.value.trim();
            if (email && isValidEmail(email)) {
                showToast('Thank you for subscribing!', 'success');
                emailInput.value = '';
            } else {
                showToast('Please enter a valid email address', 'error');
            }
        });
    }
    
    function isValidEmail(email) {
        const emailRegex = /^[^@@s]+@@[^@@s]+\.+[^@@s]+$/;
        return emailRegex.test(email);
    }

    const addToCartButtons = document.querySelectorAll('.add-to-cart-btn');
    addToCartButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();

            const productId = this.dataset.productId;
            const quantity = this.dataset.quantity || 1;
            const originalText = this.innerHTML;
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Adding...';
            this.disabled = true;

            fetch('/Products/AddToCart', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'X-Requested-With': 'XMLHttpRequest'
                },
                body: `productId=${encodeURIComponent(productId)}&quantity=${encodeURIComponent(quantity)}`
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    updateCartCount(data.cartCount);
                    showToast('Product added to cart!', 'success');
                } else {
                    showToast(data.message || 'Failed to add to cart.', 'error');
                }
            })
            .catch(() => {
                showToast('Error adding to cart.', 'error');
            })
            .finally(() => {
                this.innerHTML = originalText;
                this.disabled = false;
                this.classList.add('btn-success');
                setTimeout(() => {
                    this.classList.remove('btn-success');
                }, 1000);
            });
        });
    });

    function updateCartCount(count) {
        const cartBadge = document.getElementById('cart-badge');
        if (cartBadge && typeof count === 'number') {
            cartBadge.textContent = count;
            cartBadge.style.transform = 'scale(1.3)';
            setTimeout(() => {
                cartBadge.style.transform = 'scale(1)';
            }, 200);
        }
    }
});
</script> 